YUI.add("_shared_module_calendar_dialog_save_changes_dialog_rollup",function(a){a.namespace("ui.Templates");a.ui.Templates._shared_module_calendar_dialog_save_changes_dialog_rollup={base:'<div id="modal-saveChanges" class="modal"> <h2 class="modal-hd"> {{str_cal_saveChanges}} <span class="icon close" data-action="cancel" title="{{str_btn_close}}"></span> </h2> <div class="modal-bd"> <p>{{message}}</p> </div> <div class="modal-ft"> <span id="okayModalOverlay" class="btn left right default"> <a href="#" data-action="{{from_list}}{{list_name}}{{list_name_else}}{{event_edit_yes}}">{{str_yes}}</a></span><span id="cancelModalOverlay" class="btn left right"><a href="#" class="close" data-action="{{event_edit_no}}{{event_edit_no_else}}">{{str_no}}</a></span><span id="cancelModalOverlay" class="btn left right"><a href="#" title="{{str_btn_cancel}}" class="close" role="button" data-action="cancel">{{str_btn_cancel}}</a></span> </div></div>{{apply_opacity}}',message:"{{saveChanges_message}}",apply_opacity:'<div style="top:0px; display:block; z-index:15602!important;" class="yui3-overlay-mask"></div>',from_list:"remove-from-list",list_name:"delete-list",list_name_else:"delete-contact",event_edit_yes:"yes",event_edit_no:"no",event_edit_no_else:"cancel"};},"1.0.0");YUI.add("calendar-dialogs-saveChanges-view",function(d){var b=d.lib.Utils,a=[];var c=function(e){var g=this,f={dialog:{value:null},rootNode:{value:null},overlay:{value:null},template:{value:d.ui.Templates._shared_module_calendar_dialog_save_changes_dialog_rollup},message:{value:null}};d.augment(g,d.Attribute);g.addAttrs(f,e||{});d.augment(g,d.EventTarget);g.mask=null;};c.prototype={formatters:{event_edit_no:function(g,e,f){return f.get("template").event_edit_no;},event_edit_no_else:function(g,e,f){return"";},event_edit_yes:function(g,e,f){return f.get("template").event_edit_yes;},from_list:function(g,e,f){return"";},list_name:function(g,e,f){return"";},list_name_else:function(g,e,f){return"";},message:function(h,e,f){var g;g=f.get("message");return b.substitute(f.get("template").message,{saveChanges_message:g},null,null,strings);}},render:function(){var f=this,e;f.set("rootNode",d.Node.create(b.substitute(f.get("template").base,null,f.formatters,null,strings,null,f)));d.one("body").appendChild(f.get("rootNode"));f.get("rootNode").setStyle("display","block");e=new d.Overlay({contentBox:"#modal-saveChanges",visible:true,constrain:true,centered:true,tabIndex:null});f.set("overlay",e);e.render();e.show();f.mask=d.Node.create(f.get("template").apply_opacity);d.one("body").appendChild(f.mask);if(!e.get("boundingBox").hasClass("level2Overlay")){e.get("boundingBox").addClass("level2Overlay");}f.bindUI();},bindUI:function(){var e,f=this;for(e in a){d.detach(a[e]);}a=[];f.get("rootNode").one('a[data-action="yes"]').focus();a.push(f.get("overlay").get("contentBox").on("keydown",function(i){var j=this,h=j.get("rootNode").all("a"),g=h.size()-1;switch(i.keyCode){case 27:j.get("rootNode").one('a[data-action="cancel"]').simulate("click");break;case 13:i.preventDefault();i.target.simulate("click");break;case 9:i.preventDefault();if((g>0)&&(index=h.indexOf(i.target))>-1){if(i.shiftKey){h.item((index===0)?g:index-1).focus();}else{h.item((index===g)?0:index+1).focus();}}break;}},f));a.push(f.get("overlay").get("contentBox").on("click",function(l){var n=this,g,j,h,k,m;l.preventDefault();switch(l.target.getAttribute("data-action")){case"yes":n.fire("optionSelected",{saveChanges:true});n.close();break;case"no":n.fire("optionSelected",{saveChanges:false});n.close();break;case"cancel":n.fire("optionSelected",{focus:true});n.close();break;}},f));},hide:function(f){},show:function(f){},close:function(g){var f,h=this;for(f in a){d.detach(a[f]);}a=[];h.mask.remove();if(h.get("overlay")){h.get("overlay").destroy();}}};d.namespace("calendar.dialogs.saveChanges");d.calendar.dialogs.saveChanges.view=c;},"1.0.0",{requires:["node-base","node-event-delegate","attribute-base","event-base","lib-utils","_shared_module_calendar_dialog_save_changes_dialog_rollup","calendar_dialogs_css","modal_css"]});YUI.add("calendar-dialogs-saveChanges-controller",function(c){var a=[];var b=function(d){var f=this,e={rootNode:{value:null},widget:{value:null}};c.augment(f,c.Attribute);f.addAttrs(e,d||{});c.augment(f,c.EventTarget);};b.prototype={execute:function(f,d){var g=this,e;g.set("widget",new c.calendar.dialogs.saveChanges.view({message:f}));for(e in a){c.detach(a[e]);}a=[];a.push(g.get("widget").on("optionSelected",d));a.push(g.on("hide",g.get("widget").hide,g.get("widget")));a.push(g.on("show",g.get("widget").show,g.get("widget")));a.push(g.on("close",g.close));g.get("widget").render();},close:function(){var e=this,d;for(d in a){c.detach(a[d]);}a=[];e.get("widget").close();}};c.namespace("calendar.dialogs.saveChanges");c.calendar.dialogs.saveChanges.controller=b;},"1.0.0",{requires:["event-base","calendar-dialogs-saveChanges-view"]});YUI.add("calendar-notepad-folderNavigation-view",function(h){var c=h.lib.Utils,e=c.Menu,g=null,b=h.calendar.model.dataModel,d=null,a=[];var f=function(j){var l=this,k={data:{value:""},rootNode:{writeOnce:true},template:{value:h.ui.Templates._shared_module_calendar_notepad_folderlist_rollup},selectedList:{value:null},activeEdit:{value:false},contextMenu:{value:null},isSearch:{value:true}};h.augment(l,h.Attribute);l.addAttrs(k,j||{});h.augment(l,h.EventTarget);l.launch=true;};f.prototype={formatters:{folder:function(n,k,m){var o=m,j="",l;if(k.folders.length>0){for(l in k.folders){if(k.folders[l].get("id")==="12"){continue;}j=j+c.substitute(m.get("template").folder,{folderName:c.escapeHtml(c.unescapeHtml(k.folders[l].get("name"))),fid:k.folders[l].get("id")},null,null,strings,null,o);}}return j;}},render:function(){var k=this,j;k.syncUI();k.bindUI();if((k.get("data").folders.length>0)&&k.launch){j=k.get("rootNode").one('li.notepad-list[data-fid="12"]');j.addClass("selected");k.set("selectedList",j);k.launch=false;}},syncUI:function(){var p=this,l,r,q={},o=p.get("data"),m=p.get("selectedList"),s,t,n,k=false,u,j=b.get("selectedNoteFolder");r=h.Node.create('<div id="storm-listnav">'+c.substitute(p.get("template").base,{defaultFolderName:strings.str_cal_np_default_folder_name},p.formatters,p.get("data"),strings,null,p)+"</div>");l=p.get("rootNode").one("#storm-listnav");if(l){l.replace(r);}else{p.get("rootNode").appendChild(r);}if(m){s=m.getAttribute("data-fid");if(j){s=(j==="search")?"12":j;}t=p.get("rootNode").all("li.notepad-list");t.each(function(v){if(v.getAttribute("data-fid")===s){v.addClass("selected");p.set("selectedList",v);k=true;}});if(!k){u=p.get("rootNode").one('li.notepad-list[data-fid="12"]').one("a");p.clickedList({target:u,type:"simulated"});}}},bindUI:function(){var n=this,l,j,m,k;for(k in a){h.detach(a[k]);}a=[];e.setupMultiMenu(n.get("rootNode"),j,"click-list",n.get("contextMenu"),"onRightClick","in-situ");a.push(n.get("rootNode").on("click",function(q){var r=this,o,p=q.target.getAttribute("data-action");switch(p){case"click-list":r.clickedList(q);q.halt();break;case"new-note":r.newNote();q.halt();break;}},n));a.push(n.get("rootNode").on("dblclick",function(q){var r=this,o,p=q.target.getAttribute("data-action");switch(p){case"click-list":if(q.target.ancestor("li")&&(q.target.ancestor("li").getAttribute("data-fid")==="12")){return;}r.dblClickedList(q);q.halt();break;}},n));a.push(h.one("body").on("click",function(p){var q=this,o=p.target;if(o.ancestor("div.modal")){return;}q.resetEditSelection();},n));a.push(n.get("rootNode").delegate("click",function(q){var r=this,o,p=q.target.getAttribute("data-action");q.halt();},"div.lists-bg input",n));a.push(n.get("rootNode").delegate("keydown",function(o){var p=this;if(o.keyCode===13){o.preventDefault();if(p.folderNameChanged()){p.folderRename();}else{p.resetEditSelection();}}else{if(o.keyCode===27){p.resetEditSelection();}}},"div.lists-bg input",n));a.push(n.get("rootNode").one("#new-list-name-add").on("click",function(o){var p=this;p.get("rootNode").one("#new-list-name-add").select();},n));a.push(n.get("rootNode").one("#new-list-name-add").on("keydown",function(o){var p=this;if(o.keyCode===13){p.addFolder(o);}else{if(o.keyCode===27){p.get("rootNode").one("#new-list-name-add").set("value",strings.str_cal_np_new_folder).blur();}}},n));a.push(n.get("rootNode").one("#new-list-name-add").on("blur",function(o){var p=this;if(h.Lang.trim(p.get("rootNode").one("#new-list-name-add").get("value"))===""){p.get("rootNode").one("#new-list-name-add").set("value",strings.str_cal_np_new_folder);}},n));},openUIEdit:function(k){var m=this,l=k.details[0],j;if(!l){return;}j=m.get("rootNode").one('li.notepad-list[data-fid="'+l+'"]').one("a");m.clickedList({target:j,type:"simulated"});setTimeout(function(){m.dblClickedList({target:j});},10);},clickedList:function(m){var n=this,l=m.target.ancestor("li"),j=n.get("selectedList"),k=b.get("noteActiveEdit");if(!l){return;}h.lib.utils.Stats.stampPage("1350750006");if(k){dialog=new h.calendar.dialogs.saveChanges.controller();dialog.execute(strings.str_cal_np_save_changes,function(p){var o=b.getNotes({uid:b.get("selectedNote")});if(p.details[0].focus){return;}else{if(p.details[0].saveChanges){b.updateNote({uid:o.get("uid"),summary:h.one("input#note-title-edit").get("value"),description:h.one("textarea#note-body-edit").get("value")},{success:function(){n.handleClickedList(j,l);},failure:function(){}});}else{n.handleClickedList(j,l);}}});}else{n.handleClickedList(j,l);}},handleClickedList:function(j,k){var l=this;if(j){if((j.getAttribute("data-fid")===k.getAttribute("data-fid"))&&(!l.get("isSearch"))){return;}else{j.removeClass("selected");j.one("div.lists-bg").setStyle("display","none");l.get("activeEdit")&&j.one("a").setStyle("display","block");}}k.addClass("selected");l.set("selectedList",k);l.fire("view:folderSelected",k.getAttribute("data-fid"));},dblClickedList:function(k){var n=this,l,j=k.target.ancestor("li"),m;if(!j){return;}m=j.one("div.lists-bg");if(m.getStyle("display")==="none"){m.setStyle("display","block");j.one("a").setStyle("display","none");setTimeout(function(){m.one("input").select();},10);n.set("activeEdit",true);}},resetEditSelection:function(){var l=this,k=l.get("activeEdit"),j=l.get("selectedList");if(l.folderNameChanged()){l.folderRename();}else{if(j){j.one("div.lists-bg").setStyle("display","none");j.one("a").setStyle("display","block");}}},folderRename:function(){var n=this,m=n.get("activeEdit"),j=n.get("selectedList"),l,k;if(m){l=j.one("input").get("value");k=j.getAttribute("data-fid");if(h.Lang.trim(l)===""){return;}l=l.replace(/\/|\"|\:/g,"");n.fire("view:folderUpdated",{folderName:l,folderId:k});}},folderNameChanged:function(){var n=this,m=n.get("activeEdit"),k=n.get("selectedList"),l,j=n.get("data").folders;if(!m){return false;}l=k.getAttribute("data-fid");for(i in j){if(l===j[i].get("id")){if(k.one("input").get("value")!==j[i].get("name")){if(h.Lang.trim(k.one("input").get("value"))===""){k.one("input").set("value",j[i].get("name"));return false;}else{return true;}}}}return false;},addFolder:function(j){var l=this,k=j.target.get("value");if(h.Lang.trim(k)===""){l.get("rootNode").one("#new-list-name-add").blur();return;}k=k.replace(/\/|\"/g,"");l.fire("view:addFolder",{folderName:k});},newNote:function(){var j=this;j.fire("view:newNote");},hide:function(j){},show:function(j){},close:function(k){var l=this,j;for(j in a){h.detach(a[j]);}a=[];l.get("rootNode").one("#storm-listnav").remove(true);}};h.namespace("calendar.notepad.folderNavigation");h.calendar.notepad.folderNavigation.view=f;},"1.0.0",{requires:["node-base","node-event-delegate","attribute-base","event-base","lib-utils","lib-utils-menu","_shared_module_calendar_notepad_folderlist_rollup","calendar-dialogs-saveChanges-controller"]});YUI.add("_shared_module_calendar_notepad_folder_context_menu",function(a){a.namespace("ui.Templates");a.ui.Templates._shared_module_calendar_notepad_folder_context_menu={base:'<div id="menu-folder-context" class="optionMenu"> <ul class="first"> <li data-action="folder-rename"><a href="#">{{str_cal_np_rename_folder}}</a></li> <li data-action="folder-delete"><a href="#">{{str_cal_np_delete_folder}}</a></li> </ul></div>'};},"1.0.0");YUI.add("calendar-notepad-folderContextMenu-view",function(d){var b=d.lib.Utils,a=[];var c=function(e){var g=this,f={rootNode:{value:null},template:{value:d.ui.Templates._shared_module_calendar_notepad_folder_context_menu}};d.augment(g,d.Attribute);g.addAttrs(f,e||{});d.augment(g,d.EventTarget);};c.prototype={render:function(){var e=this;e.set("rootNode",d.Node.create(b.substitute(e.get("template").base,{},null,null,strings,null,e)));d.one("body").appendChild(e.get("rootNode"));e.bindUI();},syncUI:function(e){var f=this;if(e.fid&&e.fid==="12"){f.get("rootNode").all("li").setStyle("display","none");}else{f.get("rootNode").all("li").setStyle("display","block");}},bindUI:function(){var e;for(e in a){d.detach(a[e]);}a=[];},hide:function(f){},show:function(f){},close:function(g){var h=this,f;for(f in a){d.detach(a[f]);}a=[];if(h.get("rootNode")){h.get("rootNode").remove(true);}}};d.namespace("calendar.notepad.folderContextMenu");d.calendar.notepad.folderContextMenu.view=c;},"1.0.0",{requires:["node-base","node-event-delegate","attribute-base","event-base","lib-utils","_shared_module_calendar_notepad_folder_context_menu"]});YUI.add("calendar-notepad-folderContextMenu-controller",function(d){var a=d.calendar.model.dataModel,b=d.lib.utils.Stats.ultTracker;var c=function(e){var g=this,f={rootNode:{value:null},widget:{value:null},currentFolder:{value:null}};d.augment(g,d.Attribute);g.addAttrs(f,e||{});g.evt=[];d.augment(g,d.EventTarget);g.currentButton=null;g.process();};c.prototype={process:function(){var f=this,e;f.set("widget",new d.calendar.notepad.folderContextMenu.view());f.get("widget").render();f.set("rootNode",f.get("widget").get("rootNode"));for(e in f.evt){d.detach(f.evt[e]);}f.evt=[];f.evt.push(f.on("menu:selected",f.handleAction,f));f.evt.push(f.on("menu:show",f.updateState,f));f.evt.push(f.on("menu:hide",function(){f.fire("context:hide");}));f.evt.push(f.on("close",f.close));},handleAction:function(g){var h=this,f=h.get("currentFolder");if(!f){return;}switch(g.details[0].getAttribute("data-action")){case"folder-rename":h.fire("contextMenu:rename",f);h.set("currentFolder",null);break;case"folder-delete":h.fire("contextMenu:delete",f);h.set("currentFolder",null);break;}},updateState:function(g){var i=this,f=g.details[0].target.ancestor("li",true),h;h=unescape(f.getAttribute("data-fid"));i.set("currentFolder",h);i.get("widget").syncUI({fid:h});i.fire("context:show",f);},close:function(){var f=this,e;for(e in f.evt){d.detach(f.evt[e]);}f.evt=[];f.get("widget").close();}};d.namespace("calendar.notepad.folderContextMenu");d.calendar.notepad.folderContextMenu.controller=c;},"1.0.0",{requires:["event-base","lib-utils-stats","calendar-notepad-folderContextMenu-view","calendar-model-datamodel","calendar-model-event"]});YUI.add("_shared_module_calendar_dialog_del_event_postcard_rollup",function(a){a.namespace("ui.Templates");a.ui.Templates._shared_module_calendar_dialog_del_event_postcard_rollup={base:'<div id="modal-delevt" class="modal"> <h2 class="modal-hd"> {{header}} <span class="icon close" data-action="cancel" title="{{str_btn_close}}"></span> </h2> <div class="modal-bd"> <p>{{body}}</p> </div> <div class="modal-ft"> {{del}} {{res}} </div></div>{{apply_opacity}}',header:"{{widgetHeader}}",body:"{{widgetBody}}",list_name:"delete-list",list_name_else:"delete-contact",del:'<span id="okayModalOverlay" class="btn left right default"><a href="#" data-action="{{list_name}}{{list_name_else}}">{{str_delete}}</a></span> <span id="cancelModalOverlay" class="btn left right"><a href="#" title="{{str_btn_cancel}}" class="close" role="button" data-action="cancel">{{str_btn_cancel}}</a></span> ',res:'<span id="resetModalOverlay" class="btn left right"><a href="#" title="{{str_cal_share_reset_confirm}}" class="reset-btn" role="button" data-action="reset">{{str_cal_share_reset_confirm}}</a></span><span id="cancelModalOverlay" class="btn left right default"><a href="#" title="{{str_btn_cancel}}" class="close" role="button" data-action="cancel">{{str_btn_cancel}}</a></span> ',apply_opacity:'<div style="top:0px; display:block; z-index:15580" class="yui3-overlay-mask"></div>'};},"1.0.0");YUI.add("calendar-dialogs-confirmDelete-view",function(d){var b=d.lib.Utils,a=[];var c=function(e){var g=this,f={rootNode:{value:null},overlay:{value:null},template:{value:d.ui.Templates._shared_module_calendar_dialog_del_event_postcard_rollup},dlgType:{value:0}};d.augment(g,d.Attribute);g.addAttrs(f,e||{});d.augment(g,d.EventTarget);g.mask=null;};c.prototype={formatters:{body:function(g,e,f){switch(e.dlgType){case 1:return b.substitute(f.get("template").body,{widgetBody:strings.str_cal_deleteeventconfirm},null,null,strings);break;case 2:return b.substitute(f.get("template").body,{widgetBody:strings.str_cal_deletetodoconfirm},null,null,strings);break;case 3:return b.substitute(f.get("template").body,{widgetBody:strings.str_cal_np_delete_conf_folder},null,null,strings);break;case 4:return b.substitute(f.get("template").body,{widgetBody:strings.str_cal_np_delete_note},null,null,strings);break;case 5:return b.substitute(f.get("template").body,{widgetBody:strings.str_cal_share_reset_msg},null,null,strings);break;}},header:function(g,e,f){switch(e.dlgType){case 1:return b.substitute(f.get("template").header,{widgetHeader:strings.str_cal_mod_deleteevent},null,null,strings);case 2:return b.substitute(f.get("template").header,{widgetHeader:strings.str_cal_mod_deltodo},null,null,strings);case 3:return b.substitute(f.get("template").header,{widgetHeader:strings.str_cal_np_delete_header},null,null,strings);case 4:return b.substitute(f.get("template").header,{widgetHeader:strings.str_cal_np_delete_header},null,null,strings);case 5:return b.substitute(f.get("template").header,{widgetHeader:strings.str_cal_share_reset},null,null,strings);}},del:function(g,e,f){if(e.dlgType==5){return"";}return b.substitute(f.get("template").del,{list_name:f.get("template").list_name},null,null,strings);},res:function(g,e,f){if(e.dlgType!=5){return"";}return b.substitute(f.get("template").res,{},null,null,strings);},list_name:function(g,e,f){return b.substitute(f.get("template").list_name,{},null,null,strings);}},render:function(){var e=this;e.set("rootNode",d.Node.create(b.substitute(e.get("template").base,{},e.formatters,{dlgType:e.get("dlgType")},strings,null,e)));d.one("body").appendChild(e.get("rootNode"));e.get("rootNode").setStyle("display","block");e.set("overlay",new d.Overlay({contentBox:"#modal-delevt",visible:true,constrain:true,centered:true,zIndex:15600,tabIndex:null}));e.get("overlay").render();e.get("overlay").show();e.mask=d.Node.create(e.get("template").apply_opacity);d.one("body").appendChild(e.mask);e.bindUI();},bindUI:function(){var e,f=this;for(e in a){d.detach(a[e]);}a=[];if(f.get("dlgType")==5){f.get("rootNode").one('a[data-action="cancel"]').focus();}else{f.get("rootNode").one('a[data-action="delete-list"]').focus();}a.push(f.get("overlay").get("contentBox").on("keydown",function(i){var j=this,h=j.get("rootNode").all("a"),g=h.size()-1;switch(i.keyCode){case 27:j.get("rootNode").one('a[data-action="cancel"]').simulate("click");break;case 13:i.preventDefault();i.target.simulate("click");break;case 9:i.preventDefault();if((g>0)&&(index=h.indexOf(i.target))>-1){if(i.shiftKey){h.item((index===0)?g:index-1).focus();}else{h.item((index===g)?0:index+1).focus();}}break;}},f));a.push(f.get("overlay").get("contentBox").on("click",function(l){var n=this,g,j,h,k,m;l.preventDefault();switch(l.target.getAttribute("data-action")){case"reset":case"delete-list":n.fire("deleteConfirmed",{check:true});n.close();break;case"cancel":n.fire("deleteConfirmed",{check:false});n.close();n.fire("close");break;}},f));},hide:function(f){},show:function(f){},close:function(g){var f,h=this;for(f in a){d.detach(a[f]);}a=[];h.mask.remove();h.get("overlay").destroy();}};d.namespace("calendar.dialogs.confirmDelete");d.calendar.dialogs.confirmDelete.view=c;},"1.0.0",{requires:["node-base","node-event-delegate","attribute-base","event-base","lib-utils","_shared_module_calendar_dialog_del_event_postcard_rollup","calendar_dialogs_css","modal_css"]});YUI.add("calendar-dialogs-confirmDelete-controller",function(c){var a=[];var b=function(d){var f=this,e={rootNode:{value:null},widget:{value:null},dlgType:{value:0}};c.augment(f,c.Attribute);f.addAttrs(e,d||{});c.augment(f,c.EventTarget);};b.prototype={execute:function(f){var e=this,d;e.set("widget",new c.calendar.dialogs.confirmDelete.view({dlgType:e.get("dlgType")}));for(d in a){c.detach(a[d]);}a=[];a.push(e.on("hide",e.get("widget").hide,e.get("widget")));a.push(e.on("show",e.get("widget").show,e.get("widget")));a.push(e.on("close",e.close));a.push(e.get("widget").on("deleteConfirmed",f));e.get("widget").render();},close:function(){var e=this,d;for(d in a){c.detach(a[d]);}a=[];e.get("widget").close();}};c.namespace("calendar.dialogs.confirmDelete");c.calendar.dialogs.confirmDelete.controller=b;},"1.0.0",{requires:["event-base","calendar-dialogs-confirmDelete-view"]});YUI.add("calendar-notepad-folderNavigation-controller",function(d){var a=[],b=d.calendar.model.dataModel;var c=function(e){var g=this,f={rootNode:{writeOnce:true},widget:{value:null}};d.augment(g,d.Attribute);g.addAttrs(f,e||{});d.augment(g,d.EventTarget);};c.prototype={process:function(){var g=this,f,e=new d.calendar.notepad.folderContextMenu.controller();g.set("widget",new d.calendar.notepad.folderNavigation.view({rootNode:g.get("rootNode"),contextMenu:e}));for(f in a){d.detach(a[f]);}a=[];a.push(b.on("datamodel:foldersUpdated",g.updateState,g));a.push(b.on("datamodel:noteFolderChange",g.folderChange,g));a.push(g.get("widget").on("view:folderSelected",g.folderSelected,g));a.push(g.get("widget").on("view:addFolder",g.addFolder,g));a.push(g.get("widget").on("view:newNote",g.newNote,g));a.push(g.get("widget").on("view:folderUpdated",g.updateFolder,g));a.push(g.on("hide",g.get("widget").hide,g.get("widget")));a.push(g.on("show",g.get("widget").show,g.get("widget")));a.push(g.on("close",g.get("widget").close,g.get("widget")));a.push(e.on("contextMenu:rename",g.openUIEdit,g));a.push(e.on("contextMenu:delete",g.deleteFolder,g));g.updateState();},updateState:function(g){var h=this,f={};f.folders=b.getFolders({type:"JOURNAL"}).sort(function(j,i){var e=j.get("name").toLowerCase(),k=i.get("name").toLowerCase();return((e<k)?-1:((e>k)?1:0));});h.get("widget").set("data",f);h.get("widget").render();if(d.lib.utils.Stats.isLaunch){d.lib.utils.Stats.stampPage("1350750012",true);}},folderSelected:function(f){var g=this;b.set("selectedNoteFolder",f.details[0]);},folderChange:function(){var f=this,e=b.get("selectedNoteFolder");if(e==="search"){f.get("widget").set("isSearch",true);f.updateState();}else{f.get("widget").set("isSearch",false);}},updateFolder:function(f){var g=this;b.updateFolder(f.details[0].folderId,{name:f.details[0].folderName},null);},addFolder:function(e){var f=this;b.createFolder({folder:{name:e.folderName,type:"JOURNAL"}});},newNote:function(){var e=this;d.lib.utils.Stats.stampPage("1350750003");d.fire("leftPane:addNote");},openUIEdit:function(f){var g=this;g.get("widget").openUIEdit(f);},deleteFolder:function(g){var i=this,h=g.details[0],f;if(!h){return;}f=new d.calendar.dialogs.confirmDelete.controller({dlgType:3});f.execute(function(j){if(j.check){d.lib.utils.Stats.stampPage("1350750005",true);b.deleteFolder(h);}});}};d.namespace("calendar.notepad.folderNavigation");d.calendar.notepad.folderNavigation.controller=c;},"1.0.0",{requires:["event-base","calendar-notepad-folderNavigation-view","calendar-model-datamodel","calendar-notepad-folderContextMenu-controller","calendar-dialogs-confirmDelete-controller"]});YUI.add("_shared_module_calendar_notepad_toolbar",function(a){a.namespace("ui.Templates");a.ui.Templates._shared_module_calendar_notepad_toolbar={base:'<div id="pagetoolbar" class="hasnomsg"> <span class="btn left onemsg" id="move-button"> <i class="icon-move"></i> <span class="icon-text" data-action="move-note" title="{{str_cal_np_move}}">{{str_cal_np_move}}</span> <b class="icon icon-chevron-down"></b> </span> <span class="btn left onemsg" id="delete-button"> <i class="icon-delete"></i> <span class="icon-text" data-action="delete-note" title="{{str_cal_np_delete}}">{{str_cal_np_delete}}</span> </span></div>'};},"1.0.0");YUI.add("calendar-notepad-toolbar-view",function(c){var d=c.lib.Utils,f=d.Menu,g=c.lib.utils.Stats.ultTracker,a=null,i=null,e=null,h=[];var b=function(j){var l=this,k={data:{value:null},rootNode:{writeOnce:true},template:{value:c.ui.Templates._shared_module_calendar_notepad_toolbar},menu:{value:null},active:{value:false}};c.augment(l,c.Attribute);l.addAttrs(k,j||{});c.augment(l,c.EventTarget);};b.prototype={formatters:{},render:function(){var j=this;j.get("rootNode").appendChild(c.Node.create(d.substitute(j.get("template").base,{},{},null,strings,null,j)));j.get("rootNode").one("#move-button").setAttribute("disabled","true");j.bindUI();},syncUI:function(j){var k=this;if(j){k.get("rootNode").one("#pagetoolbar").removeClass("hasnomsg");k.get("rootNode").one("#move-button").removeAttribute("disabled");k.set("active",true);}else{k.get("rootNode").one("#pagetoolbar").addClass("hasnomsg");k.get("rootNode").one("#move-button").setAttribute("disabled","true");k.set("active",false);}},bindUI:function(){var k=this,j=k.get("rootNode");f.setupMenu(j.one("#move-button"),k.get("menu"),null,true);h.push(k.get("rootNode").one("#delete-button").on("click",function(n){var o=this,l,m;if(!o.get("active")){return;}o.fire("view:delete");},k));},hide:function(j){},show:function(j){},close:function(k){var l=this,j;for(j in h){c.detach(h[j]);}h=[];if(l.get("rootNode").one("#pagetoolbar")){l.get("rootNode").one("#pagetoolbar").remove(true);}}};c.namespace("calendar.notepad.toolbar");c.calendar.notepad.toolbar.view=b;},"1.0.0",{requires:["node","node-event-delegate","attribute-base","event-base","_shared_module_calendar_notepad_toolbar","lib-utils-menu","lib-utils"]});